# CIFAR-10 I-JEPA configuration
# Adapted from Meta I-JEPA for 32×32 images, patch_size=4, 8×8 grid.

# --- Data ---
data_root: ./data
batch_size: 256
num_workers: 4
crop_size: 32

# --- Model (ViT-Tiny scale) ---
patch_size: 4        # 32/4 = 8 patches per side → 64 total
embed_dim: 192
depth: 6
num_heads: 3
pred_embed_dim: 96
pred_depth: 4
pred_num_heads: 3

# --- Masking (block masking on 8×8 grid) ---
enc_mask_scale: [0.85, 1.0]    # context sees 85–100% of patches
pred_mask_scale: [0.15, 0.25]  # each target block covers 15–25%
aspect_ratio: [0.75, 1.5]
nenc: 1                        # 1 context mask
npred: 4                       # 4 target blocks
min_keep: 4
allow_overlap: false

# --- Optimization ---
epochs: 200
lr: 1.0e-3
start_lr: 1.0e-4
final_lr: 1.0e-6
warmup: 10                     # warmup epochs
weight_decay: 0.05
final_weight_decay: 0.05
ema_start: 0.996
ema_end: 1.0
use_amp: false                 # set true for mixed precision on GPU

# --- Logging ---
log_freq: 50
checkpoint_freq: 10
output_dir: ./output/cifar10_jepa
seed: 42
