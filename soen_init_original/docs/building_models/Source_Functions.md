---
layout: default
title: Source Functions
---
## Source Functions

<div align="center" style="margin-top: 2em; margin-bottom: 2em;">
  <a href="Solvers_and_Simulation.md" style="margin-right: 2em;">&#8592; Previous: Solvers and Simulation</a>
  &nbsp;|&nbsp;
  <a href="../index.md" class="nav-home">Home</a>
  &nbsp;|&nbsp;
  <a href="../Training_Models.md" style="margin-left: 2em;">Next: Training Models &#8594;</a>
</div>

This page explains **source functions** in the SOEN framework: what they are, how they work, and how they relate to the underlying physics.

### What is a Source Function?

A **Source Function** $g(\phi, i_{squid})$ defines the nonlinear relationship between the input flux $\phi$ and the resulting current/voltage signal generated by the SQUID (Superconducting QUantum Interference Device) component of a dendrite or multiplier circuit.

It is the core nonlinearity of the SOEN model, analogous to an activation function (like ReLU or Tanh) in traditional neural networks, but physically grounded in superconducting circuit dynamics.

Mathematically, it appears in the dendrite phenomenological equation:

$$ \dot{s} = \gamma^{+} \cdot g(\phi, i_{squid}) - \gamma^{-} \cdot s $$

where:
- $\phi$: Input flux (weighted sum of upstream signals)
- $i_{squid}$: Total current passing through the SQUID part of the circuit (a function of $s$)
- $s$: State variable (integrated signal - dimensionless current stored in the superconducting integration loop)

---

### The `RateArray`: Physics-Based Truth

The primary and most accurate source function is the **RateArray**.

- **Origin:** It is not an arbitrary mathematical function. It is a lookup table derived from SPICE simulations of the physical SQUID circuit.
- **Physical Meaning:** The value $g$ represents the time-averaged voltage (or fluxon production rate) of the SQUID loop, averaged over the picosecond timescale of individual fluxon events.
- **Inputs:**
  - **Flux ($\phi$)**: Periodic control parameter (normalized to flux quantum $\Phi_0$).
  - **SQUID Current ($i_{squid}$)**: The bias current flowing through the SQUID. For a standard dendrite, this is typically $i_b - s$, meaning the current decreases as the state accumulates (negative feedback).

> **Key Insight:** The RateArray captures the complex, non-monotonic, and state-dependent nature of the superconducting device that simple analytic functions miss.

---

### Analytic Approximations

While the RateArray is the "ground truth," we provide analytic approximations for speed, and ease of use in experiments.

#### 1. Heaviside Fit
Analytical approximation to the SQUID rate array source function. Has fitted parameters to ensure a low MSE to the ground truth (RateArray) function. The adjustable parameters allow for things like increasing the smoothness of the threshold for training.

#### 3. Tanh / Sigmoid
Standard deep learning activation functions provided for comparison and debugging. These **do not** accurately model the periodic nature of SQUID response to flux.

---

### Understanding `squid_current` vs. `bias_current`

A common point of confusion is the difference between the **layer parameter** `bias_current` and the **function argument** `squid_current`.

1.  **`bias_current` ($i_b$):**
    - A constant (or learnable) parameter of the **Layer**.
    - Represents the static DC current supplied to the circuit.
    - Determines the activation threshold. Ranges approximately from 1 to 2. Normalised to the critical current of the loop.

2.  **`squid_current` ($i_{squid}$):**
    - The dynamic argument passed to the **Source Function**.
    - Represents the total current flowing through the SQUID loop *at that moment*.
    - **In a SingleDendrite:** $i_{squid} = i_b - s(t)$. The current is reduced by the accumulated signal $s(t)$, creating a self-limiting saturation effect.


---

### Code Location

Source functions are located in:
- **PyTorch:** `src/soen_toolkit/core/source_functions/`
- **JAX:** `src/soen_toolkit/utils/port_to_jax/source_functions_jax.py`

You can inspect available functions in Python:

```python
from soen_toolkit.core.source_functions import SOURCE_FUNCTIONS
print(SOURCE_FUNCTIONS.keys())
```

---

<div align="center" style="margin-top: 2em; margin-bottom: 2em;">
  <a href="Solvers_and_Simulation.md" style="margin-right: 2em;">&#8592; Previous: Solvers and Simulation</a>
  &nbsp;|&nbsp;
  <a href="../index.md" class="nav-home">Home</a>
  &nbsp;|&nbsp;
  <a href="../Training_Models.md" style="margin-left: 2em;">Next: Training Models &#8594;</a>
</div>

